<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassPortal</title>
    <link rel="stylesheet" href="style.css">


</head>
<body>

    <h1>PassPortal</h1>
    <p class="warning"><strong>Warning:</strong> Credentials are saved in plain text in your browser's local storage. This is NOT secure. Do not use for sensitive data.</p>

    <form id="credential-form">
        <h2>Add New Credential</h2>
        <div>
            <label for="website">Website/Service:</label>
            <input type="text" id="website" required>
        </div>
        <div>
            <label for="username">Username:</label>
            <input type="text" id="username" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <input type="password" id="password" required>
             <button type="button" id="toggle-password">Show</button>
        </div>
        <button type="submit">Add Credential</button>
    </form>

    <h2>Saved Credentials</h2>
    <div id="credentials-list">
        <p>No credentials saved yet.</p>
    </div>

    <script>
        // --- JavaScript Start ---
        document.addEventListener('DOMContentLoaded', () => {
            const credentialForm = document.getElementById('credential-form');
            const websiteInput = document.getElementById('website');
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const togglePasswordButton = document.getElementById('toggle-password');
            const credentialsListDiv = document.getElementById('credentials-list');

            // --- Load credentials from localStorage on page load ---
            loadCredentials();

            // --- Event Listener for form submission ---
            credentialForm.addEventListener('submit', (event) => {
                event.preventDefault(); // Prevent default page reload

                const newCredential = {
                    id: Date.now().toString(), // Simple unique ID
                    website: websiteInput.value.trim(),
                    username: usernameInput.value.trim(),
                    password: passwordInput.value // Don't trim password
                };

                if (newCredential.website && newCredential.username && newCredential.password) {
                    addCredential(newCredential);
                    // Clear the form
                    websiteInput.value = '';
                    usernameInput.value = '';
                    passwordInput.value = '';
                    passwordInput.type = 'password'; // Reset password field type
                    togglePasswordButton.textContent = 'Show'; // Reset button text
                } else {
                    alert('Please fill in all fields.');
                }
            });

            // --- Event listener for Show/Hide password button ---
             togglePasswordButton.addEventListener('click', () => {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePasswordButton.textContent = 'Hide';
                } else {
                    passwordInput.type = 'password';
                    togglePasswordButton.textContent = 'Show';
                }
            });


            // --- Function to get credentials from localStorage ---
            function getCredentials() {
                const credentialsJson = localStorage.getItem('credentials');
                // If nothing is stored, return an empty array
                // Otherwise, parse the JSON string back into an array
                return credentialsJson ? JSON.parse(credentialsJson) : [];
            }

            // --- Function to save credentials to localStorage ---
            function saveCredentials(credentials) {
                // Convert the array of objects into a JSON string
                localStorage.setItem('credentials', JSON.stringify(credentials));
            }

            // --- Function to add a new credential ---
            function addCredential(credential) {
                const credentials = getCredentials();
                credentials.push(credential);
                saveCredentials(credentials);
                renderCredentials(); // Update the displayed list
            }

            // --- Function to delete a credential ---
            function deleteCredential(id) {
                let credentials = getCredentials();
                // Filter out the credential with the matching id
                credentials = credentials.filter(cred => cred.id !== id);
                saveCredentials(credentials);
                renderCredentials(); // Update the displayed list
            }

            // --- Function to display credentials on the page ---
            function renderCredentials() {
                const credentials = getCredentials();
                credentialsListDiv.innerHTML = ''; // Clear the current list

                if (credentials.length === 0) {
                    credentialsListDiv.innerHTML = '<p>No credentials saved yet.</p>';
                    return;
                }

                credentials.forEach(cred => {
                    const itemDiv = document.createElement('div');
                    itemDiv.classList.add('credential-item');

                    const infoDiv = document.createElement('div');
                    infoDiv.classList.add('credential-info');
                    // Use the escapeHtml function to prevent basic XSS issues
                    infoDiv.innerHTML = `
                        <span><strong>Website:</strong> ${escapeHtml(cred.website)}</span>
                        <span><strong>Username:</strong> ${escapeHtml(cred.username)}</span>
                        <span><strong>Password:</strong> ${escapeHtml(cred.password)}</span>
                    `;

                    const deleteButton = document.createElement('button');
                    deleteButton.classList.add('delete-button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.onclick = () => deleteCredential(cred.id); // Arrow function to pass the id

                    itemDiv.appendChild(infoDiv);
                    itemDiv.appendChild(deleteButton);
                    credentialsListDiv.appendChild(itemDiv);
                });
            }

             // --- Function to escape HTML characters to prevent basic XSS ---
             // IMPORTANT: Still not truly secure, but better than nothing.
            function escapeHtml(unsafe) {
                if (typeof unsafe !== 'string') {
                    // Handle cases where input might not be a string
                    return '';
                }
                return unsafe
                     .replace(/&/g, "&amp;")
                     .replace(/</g, "&lt;")
                     .replace(/>/g, "&gt;")
                     .replace(/"/g, "&quot;")
                     .replace(/'/g, "&#039;");
             }

            // --- Function to load and render credentials initially ---
            function loadCredentials() {
                renderCredentials();
            }
        });
        // --- JavaScript End ---
    </script>

</body>
</html>